## 目标
- 将上传对话框的选择顺序改为：先选择考核类型（type_id），再根据所选类型动态加载/筛选指标列表。
- 保证后端数据与 indicator_data_v2 的 type_id 一致性，前端表单校验完整。

## 前端改造（Dashboard.vue）
- 表单布局调整：
  - 将“考核类型”选择移到“指标名称”之前，并将“指标名称”选择禁用（disabled）直到选择了考核类型。
- 依赖加载与联动：
  - 当选择了考核类型（type_id）后，拉取该类型下的指标列表填充“指标名称”下拉。
  - 校验：type_id 与 indicator_id 必填。
- 实现方式（两种择一）：
  1) 后端新增按类型查询简版指标接口（推荐）：
     - GET /api/v1/metrics/indicators_by_type?type_id=xxx → 返回简版指标列表（id、name、code）。
     - 组件在用户选择类型时调用该接口，得到“指标名称”候选项。
  2) 扩展现有简版指标接口返回 type_id，前端自行过滤：
     - 将 [IndicatorSimpleOut](file:///g:/Project/data_proj_v1_trae/app/models/metrics_schemas.py) 增加 type_id 字段；
     - [get_indicators_list](file:///g:/Project/data_proj_v1_trae/app/api/endpoints/indicators.py#L55-L61) 返回全部指标后，前端根据 type_id 过滤。

## 后端改造
- 若选方案 1：新增接口
  - 路由：GET /api/v1/metrics/indicators_by_type
  - 入参：type_id（必填），支持分页可选（如 items≤1000 可一次返回）。
  - 返回：List[IndicatorSimpleOut]（包含 indicator_id、indicator_name、indicator_code）。
  - 服务：select(Indicator) where Indicator.type_id == :type_id and Indicator.status==1，按名称排序。
- 若选方案 2：扩展简版指标结构
  - 在 [IndicatorSimpleOut](file:///g:/Project/data_proj_v1_trae/app/models/metrics_schemas.py) 增加 type_id 字段；
  - [get_all_indicators_simple](file:///g:/Project/data_proj_v1_trae/app/services/indicator_service.py#L632-L638) 查询返回时映射 type_id；
  - 前端在切换 type_id 时前端过滤。

## 数据一致性与验证
- 创建数据：已在 [create_indicator_data](file:///g:/Project/data_proj_v1_trae/app/services/indicator_service.py#L641-L695) 校验 type_id 与 Indicator.type_id 的一致性；前端提交时包含 type_id。
- Excel上传：已支持 type_id/type_name 列，且进行一致性校验。[indicators.py:upload](file:///g:/Project/data_proj_v1_trae/app/api/endpoints/indicators.py#L198-L252)

## 交互与校验
- UI：
  - 未选择考核类型时，“指标名称”下拉禁用或显示“请先选择考核类型”。
  - 选择考核类型后异步加载指标列表，loading 状态提示。
- 表单校验：type_id、indicator_id、district_id、stat_date、value 必填。

## 验证用例
- 选择类型 A → 指标下拉仅显示类型 A 的指标；选择并提交后，/metrics/query 按 type_id 能查询到新增数据。
- 切换类型 B → 指标下拉刷新为类型 B 的候选项。

## 备注
- 推荐方案 1（后端按类型查询指标），返回体小、性能好、逻辑清晰；若为最小改动可选方案 2（扩展简版结构并前端过滤）。
- 两种方案均不影响现有分页与展示逻辑。