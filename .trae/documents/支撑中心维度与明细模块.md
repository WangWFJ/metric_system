## 需求拆解

* 新增“支撑中心”维度（`centers`）与“支撑中心指标数据”（`indicator_center_data`）两张表。

* 增加“支撑中心明细”模块：功能类似现有“区县明细”，但不展示“豁免值/零容忍值”，按支撑中心查看该中心某期/某时间段的数据。

## 现状复用点（不改动现有区县逻辑）

* 现有“区县明细/指标明细”页面是 [Dashboard.vue](file:///d:/Users/JUN/Desktop/data_proj_v1_trae（docker）v1/frontend/src/views/Dashboard.vue) ，数据来自 `GET /api/v1/metrics/query`。

* 后端已有“按区县某一天返回该区县全指标”的接口：`GET /api/v1/metrics/district`，实现模式可直接复用到 center 维度（定位实体→日期 fallback→返回指标列表）。

## 后端改造（API + Service + ORM + Schema）

### 1) ORM 模型

* 在 [metrics.py](file:///d:/Users/JUN/Desktop/data_proj_v1_trae（docker）v1/app/models/metrics.py) 新增：

  * `Center`（映射 `centers`：`center_id, district_id, center_name`）

  * `IndicatorCenterData`（映射 `indicator_center_data`：含你给定字段）

### 2) Pydantic Schema

* 在 [metrics\_schemas.py](file:///d:/Users/JUN/Desktop/data_proj_v1_trae（docker）v1/app/models/metrics_schemas.py) 新增：

  * `CenterOut`（中心下拉用）

  * `CenterIndicatorValue`（不含 `exemption/zero_tolerance`）

  * `CenterMetricsResponse`（center 明细：`center_id/center_name/district_id/stat_date/indicators[]`）

  * （可选）`IndicatorCenterDataOut/IndicatorCenterDataResponse`（用于分页查询表格）

### 3) Service 层

* 在 [indicator\_service.py](file:///d:/Users/JUN/Desktop/data_proj_v1_trae（docker）v1/app/services/indicator_service.py) 新增：

  * `get_all_centers(session, district_id?)`：中心列表（可按区县过滤）

  * `get_indicators_by_center(session, center_id|center_name, stat_date?)`：仿照 `get_indicators_by_district`，返回某中心某天（或最新一天）的“全指标列表”，但返回字段不含豁免/零容忍

  * `query_center_metrics(...)`：仿照 `query_metrics`，用于中心维度“明细表”分页查询（支持 indicator/type/major/center/district/dateRange/order\_by）

  * `query_center_series(...)`：如果后续需要“中心趋势图”

### 4) API 路由

* 在 [indicators.py](file:///d:/Users/JUN/Desktop/data_proj_v1_trae（docker）v1/app/api/endpoints/indicators.py) 增加 endpoints（沿用现有权限 `indicator_data:view` 等，避免改权限系统）：

  * `GET /api/v1/metrics/centers?district_id=`：中心下拉

  * `GET /api/v1/metrics/center`：中心明细（类似 `/metrics/district`）

  * `GET /api/v1/metrics/center/query`：中心维度明细分页（类似 `/metrics/query`）

  * 导出接口：`/metrics/center/export`、`/metrics/center/export_v2`

### 5) 指标元信息同步（一致性）

* 现有指标编辑会同步 `indicator_data_v2` 的冗余字段（indicator\_name/type\_id/major\_id/is\_positive）。

* 将同样的同步扩展到 `indicator_center_data`，防止编辑指标后中心数据分类信息不一致。

## 前端改造（支撑中心明细模块）

### 1) 新增页面

* 新增 `frontend/src/views/CenterDashboard.vue`：

  * 布局/交互参照 [Dashboard.vue](file:///d:/Users/JUN/Desktop/data_proj_v1_trae（docker）v1/frontend/src/views/Dashboard.vue)

  * 表格列：`指标名称/支撑中心/区县名/完成值/基准值/挑战值/得分/日期`

  * 不显示：`豁免值/零容忍值`

### 2) 新增 API 封装

* 在 [indicator.ts](file:///d:/Users/JUN/Desktop/data_proj_v1_trae（docker）v1/frontend/src/api/indicator.ts) 增加：

  * `getCenters(params?: { district_id?: number })`

  * `getCenterData(params...)`（对应 `/metrics/center/query`）

  * （可选）`getCenterDetail(params...)`（对应 `/metrics/center`，用于“某中心某天全指标清单”弹窗）

### 3) 路由与菜单

* 在 [router/index.ts](file:///d:/Users/JUN/Desktop/data_proj_v1_trae（docker）v1/frontend/src/router/index.ts) 增加路由 `/center-dashboard`（或 `/center-detail`）。

* 在 [MainLayout.vue](file:///d:/Users/JUN/Desktop/data_proj_v1_trae（docker）v1/frontend/src/layout/MainLayout.vue) 的“指标数据”分组下新增“支撑中心明细”入口。

## 数据库与部署注意

* 你提供的 `CREATE TABLE` 需要先在生产数据库执行（项目当前无 Alembic/迁移脚本自动建表）。

* 建议同时确认 `centers.center_name` 与 `indicator_center_data.center_name` 长度一致（表里一个 128、一个 32），避免写入截断；如需我会在方案落地时按数据库实际长度对齐 ORM。

## 验证方式

* 后端：本地/测试环境用 `/api/v1/metrics/centers`、`/api/v1/metrics/center`、`/api/v1/metrics/center/query` 做基本调用验证。

* 前端：进入“支撑中心明细”，选择区县→中心→日期范围，确认列表分页/排序正常，且不展示豁免/零容忍。

确认后我将开始按以上步骤落地代码（后端 + 前
