## 问题与目标
- 趋势仅显示“相同区县同指标”的单线，无法展示该指标在所有区县的对比或在指定区县的完整时间序列。
- 上传需支持每项指标的得分(score)；查询展示时不显示单位(unit)，改为显示得分。

## 后端改造
### 新增时间序列接口
- 路由：GET /api/v1/metrics/series
- 入参：indicator_id(必填)、district_id(可选)、start_date/end_date(可选)、size(默认180)
- 行为：
  - 有 district_id → 返回该区县的完整时间序列（按 stat_date 升序）。
  - 无 district_id → 返回该指标所有区县的时间序列，前端构造成多折线，每个区县一条线。
- 返回：{ items: IndicatorDataOut[], total: number }
- 实现：基于 IndicatorDataV2 过滤，并用子查询计数，保证 total 准确。[indicator_service.py](file:///g:/Project/data_proj_v1_trae/app/services/indicator_service.py)

### 上传得分支持
- 请求模型：在 IndicatorDataCreate 增加可选 score 字段。[metrics_schemas.py](file:///g:/Project/data_proj_v1_trae/app/models/metrics_schemas.py)
- 创建逻辑：create_indicator_data 写入 score，更新时同步更新 score。[indicator_service.py:create_indicator_data](file:///g:/Project/data_proj_v1_trae/app/services/indicator_service.py#L641-L704)
- Excel 上传：读取 score 列（若存在且有效），更新/创建时写入 score。[indicators.py:upload](file:///g:/Project/data_proj_v1_trae/app/api/endpoints/indicators.py#L176-L262)

## 前端改造
### 趋势组件
- IndicatorChart：
  - 新增 districtId 可选参数；若为空，调用 /metrics/series 展示多折线（每个区县一条）；若有 districtId，仅展示该区县的时间序列。
  - 数据源改为 /metrics/series，避免混入不同区县的数据点。

### 列表展示
- Dashboard 列表不再显示单位列(unit)，新增“得分”列，显示 score。[Dashboard.vue](file:///g:/Project/data_proj_v1_trae/frontend/src/views/Dashboard.vue)
- 前端类型 IndicatorData 增加可选 score 字段。[indicator.ts](file:///g:/Project/data_proj_v1_trae/frontend/src/api/indicator.ts)

## 校验与体验
- 趋势：点击列表行时，默认传入该行 district_id→单区县时间序列；提供“全部区县”切换选项可清除 districtId→展示多折线对比（可后续追加）。
- 上传：表单支持 score；Excel 上传支持 score 列；后端校验并落库。

## 验证
- 单区县趋势：indicator_id + district_id 返回按日期的完整折线。
- 多区县趋势：indicator_id 返回多折线，每条线为一个区县。
- 列表显示：移除单位列，新增得分列，数据来自 v2。
- 上传：手工与 Excel 上传得分均可写入并查询显示。